services:
  api:
    extends:
      file: ./packages/api/docker-compose.yml
      service: api
    env_file:
      - .env.base

  mongo:
    extends:
      file: ./packages/api/docker-compose.yml
      service: mongo

  bot:
    extends:
      file: ./packages/bot/docker-compose.dev.yml
      service: bot
    env_file:
      - .env.base

  webapp:
    extends:
      file: ./packages/webapp/docker-compose.yml
      service: webapp

  ngrok:
    image: ngrok/ngrok:latest
    container_name: ts-ngrok
    command: start --config /etc/ngrok.yml --all
    volumes:
      - ./ngrok.yml:/etc/ngrok.yml:ro
    depends_on:
      - webapp
      - bot
    ports:
      - "4040:4040"

volumes:
  mongo-data: